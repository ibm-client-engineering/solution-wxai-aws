---
id: installation
sidebar_position: 3
title: Installation
custom_edit_url: null
---

### Installation Steps

#### Preparing the installion files

The default "AvailabilityZones" in ***clusters.yaml*** are **"us-east-2a,us-east-2b,us-east-2c"** but can be changed.\
To change which Availability Zones are used, search ***clusters.yaml*** for **"us-east-2a,us-east-2b,us-east-2c"** and replace with the preferred Availability Zones.\
Search ***clusters.yaml*** for "REPLACE_ME_WITH_SUBNET_ID" and replace with a specific subnetID.

#### Preparing Parameters Override file

Review ***"parameters-override.yaml"***, the following changes will need to be made
- Add API Key
- Add KeyPairName
- Add Private Subnets
- Add Public Subnets
- Add Red Hat Pull Secret s3 location
- Add VPC ID
- Add Bucket Name for s3 bucket that is being used by Red Hat Pull secret
- Add Domain Name
- Add Cluster Name
- Add CPD External Registry


#### Create OCPInstall Role
[Download the OCPInstall_Role.yaml](https://github.com/ibm-client-engineering/solution-wxai-aws/assets/Cloudformation/OCPInstall_Role.yaml)
Create the role by running the following command:

```
aws cloudformation deploy --stack-name OCPInstall-role-1 -template-file OCPInstall_Role.yaml --capabilities CAPABILITY_NAMED_IAM --tags *add Key=Value tag here*
```


#### Deply cloudformation template using AWS CLI
Using the OCPInstall role arn, run the following command to start the main cloudformation deployment:

```
aws cloudformation deploy --stack-name stack-deployment-1 --template-file cluster.yaml --parameter-overrides file://parameters-override.json --capabilities CAPABILITY_NAMED_IAM --tags *add Key=Value tag here* --role-arn arn:aws:iam::<ACCOUNT>:role/OCPInstall
```

Check the AWS Console to see when the cloudformation template has progressed far enough that the bootnode is online.

Using the ssh key from the Key Pair name used in parameters-override.yaml, ssh to the bootnode.
Check what folders exist in the ec2-home directory. if "cpd-status" has not been created yet, then wait a few minutes. Once "cpd-status" directory appears, run the following command:

```
tail -f ~/cpd-status/state/deployer-state.out
```

This command will show the log file from the cp-deployer process. 